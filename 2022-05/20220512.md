
테이블 뷰에서 서버의 고화질 이미지를 받아올 때 업로드 되는데 시간이 걸릴 수 있다.

이 상황에서 스크롤을 내렸다가 다시 올리게 되면, 이미지가 원하는 셀의 indexPath에 들어가지 않는 경우가 있다.

왜 이런 문제가 발생할까?

그리고 해결법은 어떻게 될까?

문제가 발생하는 이유는 스크롤하고 올라왔을 때 이미지가 업로드 완료되면 적절한 곳에 뿌려줘야 하는데 스크롤하게 되면

재사용 셀을 사용하므로 아까 저장할 indexPath가 어디인지 알 수 없다. 그래서 매번 동일한 결과를 내지 않는 경우가 있다.

그래서 이를 해결하기 위해서는 클로저의 캡쳐를 활용해서 확인해주어야 한다.

클로저의 캡쳐는 값을 캡쳐해두기 때문에 이 시점의 값을 기억해두고 있다.

그래서 처음 이미지가 업로드 되었을 때 시점의 tableView의 cell 속 indexPath 를 캡쳐해 둔 다음 

이미지 업로드가 완료되었을 때 시점에서 indexPath가 동일한지 확인 후에 같다면 이를 그곳에 뿌려주게 되는 것이다.

```swift
session.startLoad(url: url) { image in 
		DispatchQueue.main.async {
			if tableView.indexPath(for: cell) == indexPath {
					cell.myImageView.image = image
			}
		}
	}
```

여기에서 클로저를 통해 tableview, cell, indexPath 모두 캡쳐가 된다.
테이블 뷰의 셀이 변환될 때 클로저가 실행되어서 값이 캡쳐된 것이고
이미지가 다운로드 끝났을 때 클로저가 실행되어서 값과 비교해본다.
그래서 같다면 이미지를 동일하게 업로드 한 것이고 만약 같지 않다면 다운로드 한 이미지를 없애고 업로드 시키지 않는다.

이렇게 스크롤하고 올라왔을 때 서버 통신으로 받은 정보를 적절한 곳에 배치되도록 할 수 있다!!!